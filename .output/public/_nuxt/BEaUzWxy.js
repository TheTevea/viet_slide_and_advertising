import{r as S,P as p,S as g}from"./BLElfGiT.js";const u={1:{id:"1",name:"Moni Roy",email:"admin@vireakbuntham.com"}},i={"admin@vireakbuntham.com":"password123"},r=S(null),y=()=>{if(typeof window<"u"&&!r.value)try{const e=localStorage.getItem("authUser");e&&(r.value=JSON.parse(e))}catch(e){console.error("Could not parse user from localStorage",e)}typeof window<"u"&&p(r,e=>{e?localStorage.setItem("authUser",JSON.stringify(e)):localStorage.removeItem("authUser")},{deep:!0});const c=async(e,o)=>new Promise((s,t)=>{setTimeout(()=>{const n=Object.values(u).find(a=>a.email===e);n&&i[e]===o?(r.value=n,s()):t(new Error("Invalid email or password."))},500)}),d=async(e,o,s)=>new Promise((t,n)=>{setTimeout(()=>{if(Object.values(u).some(v=>v.email===o)){n(new Error("An account with this email already exists."));return}const a=Date.now().toString(),l={id:a,name:e,email:o};u[a]=l,i[o]=s,r.value=l,t()},500)}),m=()=>{r.value=null},f=async e=>new Promise((o,s)=>{setTimeout(()=>{if(r.value){const t={...r.value,name:e};u[r.value.id]=t,r.value=t,o()}else s(new Error("User not found."))},500)}),w=async(e,o)=>new Promise((s,t)=>{setTimeout(()=>{r.value&&i[r.value.email]===e?(i[r.value.email]=o,s()):t(new Error("Incorrect current password."))},500)});return{user:g(r),login:c,register:d,logout:m,updateProfile:f,changePassword:w}};export{y as u};
